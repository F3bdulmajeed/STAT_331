<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Least squared estimation | Regression Analysis</title>
  <meta name="description" content="This note book is for the excersices class for STAT332" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Least squared estimation | Regression Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This note book is for the excersices class for STAT332" />
  <meta name="github-repo" content="F3bdulmajeed/STAT332" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Least squared estimation | Regression Analysis" />
  
  <meta name="twitter:description" content="This note book is for the excersices class for STAT332" />
  

<meta name="author" content="Lecturer: Abdulmajeed Alharbi" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="properties-inferences-in-regression.html"/>
<script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="least-squared-estimation.html"><a href="least-squared-estimation.html"><i class="fa fa-check"></i><b>1</b> Least squared estimation</a><ul>
<li class="chapter" data-level="1.1" data-path="least-squared-estimation.html"><a href="least-squared-estimation.html#recap"><i class="fa fa-check"></i><b>1.1</b> Recap</a></li>
<li class="chapter" data-level="1.2" data-path="least-squared-estimation.html"><a href="least-squared-estimation.html#exercises"><i class="fa fa-check"></i><b>1.2</b> Exercises</a></li>
<li class="chapter" data-level="1.3" data-path="least-squared-estimation.html"><a href="least-squared-estimation.html#coursework"><i class="fa fa-check"></i><b>1.3</b> Coursework</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="properties-inferences-in-regression.html"><a href="properties-inferences-in-regression.html"><i class="fa fa-check"></i><b>2</b> Properties inferences in Regression</a><ul>
<li class="chapter" data-level="2.1" data-path="properties-inferences-in-regression.html"><a href="properties-inferences-in-regression.html#recap-1"><i class="fa fa-check"></i><b>2.1</b> Recap</a></li>
<li class="chapter" data-level="2.2" data-path="properties-inferences-in-regression.html"><a href="properties-inferences-in-regression.html#exercises-1"><i class="fa fa-check"></i><b>2.2</b> Exercises</a></li>
<li class="chapter" data-level="2.3" data-path="properties-inferences-in-regression.html"><a href="properties-inferences-in-regression.html#coursework-1"><i class="fa fa-check"></i><b>2.3</b> Coursework</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Regression Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="least-squared-estimation" class="section level1">
<h1><span class="header-section-number">1</span> Least squared estimation</h1>
<div id="recap" class="section level2">
<h2><span class="header-section-number">1.1</span> Recap</h2>
<p>Simple linear regression in an important and fundamental technique in applied statistical modeling as it is used to describe the linearity in the relationship between two variables.
Our model is:
<span class="math display">\[y_i=\beta_0+\beta_1~x_i+e_i ~~~~~~~~\text{where}~~~ i=1,2,...,n\]</span></p>
<p>Where <span class="math inline">\(\beta_0\)</span> bias parameter in the model and <span class="math inline">\(\beta_1\)</span> is the slope parameter, and the expected value of <span class="math inline">\(y\)</span> is <span class="math inline">\(E(y_i)=\hat{y}= \beta_0+\beta_1~x_i\)</span>. and the term <span class="math inline">\(e\)</span> is referring to the error in our model. the bias and the slope parameter are still need to be estimated one important technique to do this estimation is by minimizing the sum of squared error <span class="math inline">\(\sum_{i=1}^{n} e_i^2\)</span>.</p>
</div>
<div id="exercises" class="section level2">
<h2><span class="header-section-number">1.2</span> Exercises</h2>
<div class="exercise">
<p><span id="exr:unlabeled-div-1" class="exercise"><strong>Exercise 1.1  </strong></span>Find the least squared estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in the regression parameters below:
<span class="math display">\[y_i = \beta_0 +\beta_1~x_i+e_i\]</span>
where <span class="math inline">\(i =1,2, ... , n\)</span>.</p>
</div>
<p><br />
<strong>Solution:</strong><br />
</p>
<p>To find the least squared estimators for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> so we need to minimize the sum of squared error, i.e.,
<span class="math display">\[ Q = \sum_{i=1}^{n} e_i^2 = \sum_{i=1}^{n} (y_i - (\beta_0 +\beta_1~x_i))^2\]</span>
over <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. In order to calculate this optimization we need to find the first derivative for <span class="math inline">\(Q\)</span> with respect to <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.<br />
To find the least squared estimator for <span class="math inline">\(\beta_1\)</span>:<br />
</p>
<p><span class="math display">\[\begin{align}
    &amp;\frac{\partial}{\partial~\beta_1}~\sum_{i=1}^{n} (y_i - (\beta_0+\beta_1~x_i))^2\\
    &amp;= 2 \sum_{i=1}^{n} x_i (y_i - (\beta_0 +\beta_1~x_i))\\
    &amp;= 2(\sum_{i=1}^{n} x_i~y_i -~\beta_0~ \sum_{i=1}^{n}~x_i + ~\beta_1~\sum_{i=1}^{n}~x_i^2)
    
\end{align}\]</span><br />
Now by setting that to zero and solve we will end up with:<br />
</p>
<p><span class="math display">\[\begin{align}
     \hat{\beta_1} = \frac{\sum_{i=1}^{n}(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i=1}^{n}(x_i-\bar{x})^2}
    
\end{align}\]</span><br />
</p>
<p>To find the least squared estimator for <span class="math inline">\(\beta_0\)</span>:<br />
</p>
<p><span class="math display">\[\begin{align}
    &amp;\frac{\partial}{\partial~\beta_0}~\sum_{i=1}^{n} (y_i - (\beta_0+\beta_1~x_i))^2\\
    &amp;=  \sum_{i=1}^{n} (y_i - (\beta_0 +\beta_1~x_i))\\
    &amp;= n\bar{y} -n\beta_0 - n~\beta_1~\bar{x}
    
\end{align}\]</span><br />
again by setting that to zero and solve we will end up with:<br />
</p>
<p><span class="math display">\[\begin{align}
     \hat{\beta_0} = \bar{y} -\beta_1~\bar{x}
    
\end{align}\]</span></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-2" class="exercise"><strong>Exercise 1.2  </strong></span>Suppose a model states that:</p>
</div>
<p><span class="math display">\[\begin{align}

    &amp;E(y_1) = \theta,\\
    &amp;E(y_2) = 2~\theta − \phi,\\
    &amp;E(y_3) = \theta + 2~\phi.
    
\end{align}\]</span></p>
<p>Find the least squares estimates of <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span>.</p>
<p><strong>Solution:</strong><br />
Similarly to what we have done in the previous exercise we need to minimize the sum of squared error over <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span>. Let’s begin by estimating <span class="math inline">\(\theta\)</span>.</p>
<p><span class="math display">\[\begin{align}

    &amp;\frac{\partial}{\partial~\theta}~\sum_{i=1}^{n}(y_i - E(y_i))^2\\
    
    =&amp; \frac{\partial}{\partial~\theta}  ((y_1 - \theta)^2 +(y_2 -2\theta + \phi)^2 +(y_3-\theta-2\phi)^2)\\
    =&amp; -2(y_1 - \theta) - 4(y_2 -2\theta + \phi) - 2(y_3-\theta-2\phi)\\
    =&amp; -2y_1 + 2\theta -4y_2+8\theta-4\phi -2y_3+2\theta+4\phi\\
    =&amp; 12\theta - 2y_1-4y_2-2y_3
    
\end{align}\]</span></p>
<p>Therefore,
<span class="math display">\[\hat{\theta}= \frac{y_3+2y_2+y_1}{6}\]</span></p>
<p>Now, the least square estimator for <span class="math inline">\(\phi\)</span> can be founded as follow:</p>
<p><span class="math display">\[\begin{align}

    &amp;\frac{\partial}{\partial~\phi}~\sum_{i=1}^{n}(y_i - E(y_i))^2\\
    
    =&amp; \frac{\partial}{\partial~\phi}  ((y_1 - \theta)^2 +(y_2 -2\theta + \phi)^2 +(y_3-\theta-2\phi)^2)\\
    =&amp; 2(y_2 -2\theta + \phi) - 4(y_3-\theta-2\phi)\\
    =&amp; 2y_2 -4\theta +2\phi -4y_3+4\theta+8\phi\\
    =&amp; 10\phi + 2y_2-4y_3
    
\end{align}\]</span></p>
<p>Therefore,
<span class="math display">\[\hat{\phi}= \frac{2y_3-y_2}{5}\]</span></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-3" class="exercise"><strong>Exercise 1.3  </strong></span>Under certain conditions, the yield (Y) of a chemical process can be described via the relationship</p>
</div>
<p><span class="math display">\[Y = \alpha~X^\beta\]</span>
where <span class="math inline">\(X\)</span>is the amount of catalyst provided.</p>
<ol style="list-style-type: decimal">
<li>Assume that the log of the yield is normally distributed and estimate the parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> for the data given below.</li>
</ol>
<table>
<tbody>
<tr class="odd">
<td align="left">X</td>
<td align="left">0.500</td>
<td align="center">0.600</td>
<td align="center">0.700</td>
<td align="right">0.800</td>
<td align="right">0.900</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td align="left">Y</td>
<td align="left">0.241</td>
<td align="center">0.445</td>
<td align="center">0.667</td>
<td align="right">1.044</td>
<td align="right">1.358</td>
<td align="left">2.01</td>
</tr>
</tbody>
</table>
<p><br />
<strong>Solution:</strong><br />
As <span class="math display">\[Y = \alpha~X^\beta\]</span> <span class="math inline">\(\Rightarrow\)</span> <span class="math inline">\(\log(Y)=log(\alpha)+\beta\log(X)\)</span>
We assume
<span class="math display">\[Y&#39;_i= \alpha&#39;+\beta~X&#39;_i+e_i ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ i=1,2,..,n \]</span></p>
<p>Let <span class="math inline">\(\hat{\alpha&#39;}\)</span> and <span class="math inline">\(\hat{\beta}\)</span> is the least squared estimators for <span class="math inline">\(\alpha&#39;\)</span> and <span class="math inline">\(\beta\)</span> respectively, so</p>
<p><span class="math display">\[\hat{\beta}=\frac{S_{X&#39;~Y&#39;}}{S_{X&#39;X&#39;}} ~~~~~~~ \text{and} ~~~~~ \hat{\alpha&#39;}= \bar{Y&#39;}-\hat{\beta}\bar{X&#39;}\]</span></p>
<p>We can calculate that by R as follow:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="least-squared-estimation.html#cb1-1"></a>X=<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>,<span class="dv">1</span>)</span>
<span id="cb1-2"><a href="least-squared-estimation.html#cb1-2"></a>Y=<span class="kw">c</span>(<span class="fl">0.241</span>,<span class="fl">0.445</span>,<span class="fl">0.667</span>,<span class="fl">1.044</span>,<span class="fl">1.358</span>,<span class="fl">2.010</span>)</span>
<span id="cb1-3"><a href="least-squared-estimation.html#cb1-3"></a>Xdash=<span class="st"> </span><span class="kw">log</span>(X)</span>
<span id="cb1-4"><a href="least-squared-estimation.html#cb1-4"></a>Ydash=<span class="st"> </span><span class="kw">log</span>(Y)</span>
<span id="cb1-5"><a href="least-squared-estimation.html#cb1-5"></a>betahat =<span class="st"> </span><span class="kw">cov</span>(Xdash,Ydash)<span class="op">/</span><span class="kw">var</span>(Xdash)</span>
<span id="cb1-6"><a href="least-squared-estimation.html#cb1-6"></a>alpha_dash_hat =<span class="st"> </span><span class="kw">mean</span>(Ydash)<span class="op">-</span><span class="st"> </span>betahat <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(Ydash)</span>
<span id="cb1-7"><a href="least-squared-estimation.html#cb1-7"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The least squared estimator for beta is&quot;</span>, betahat, <span class="st">&quot;and the least squared estimator for log alpha is&quot;</span>, alpha_dash_hat))</span></code></pre></div>
<pre><code>## [1] &quot;The least squared estimator for beta is 2.99310690670613 and the least squared estimator for log alpha is 0.528305318701578&quot;</code></pre>
<p>Now we can calculate, so <span class="math inline">\(\hat{\alpha}= e^{0.53} = 1.7\)</span></p>
</div>
<div id="coursework" class="section level2">
<h2><span class="header-section-number">1.3</span> Coursework</h2>
<ol style="list-style-type: decimal">
<li>Watch the Youtube video by clicking <a href="https://www.youtube.com/watch?v=PaFPbb66DxQ">here</a></li>
<li>Look at iris data in R using the command <code>help(iris)</code> and fit a line to predict the petel length using the sepal length and interpret the result (you can use the function <code>lm()</code>)</li>
<li>Show that <span class="math inline">\(\hat{\beta_1}\)</span> is an unbiased estimate of for <span class="math inline">\(\beta_1\)</span>.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="properties-inferences-in-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
